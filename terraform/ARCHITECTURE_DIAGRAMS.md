# Architecture Diagrams

## ğŸ—ï¸ Infrastructure Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          AWS Cloud (Region)                          â”‚
â”‚                                                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                    VPC (Your VPC ID)                         â”‚   â”‚
â”‚  â”‚                                                               â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚   â”‚
â”‚  â”‚  â”‚         Public Subnet (Your Subnet ID)                â”‚  â”‚   â”‚
â”‚  â”‚  â”‚                                                        â”‚  â”‚   â”‚
â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚  â”‚   â”‚
â”‚  â”‚  â”‚  â”‚    Security Group (Your SG ID)              â”‚     â”‚  â”‚   â”‚
â”‚  â”‚  â”‚  â”‚                                              â”‚     â”‚  â”‚   â”‚
â”‚  â”‚  â”‚  â”‚  Inbound Rules:                             â”‚     â”‚  â”‚   â”‚
â”‚  â”‚  â”‚  â”‚  â€¢ Port 22  (SSH)   â† Your IP               â”‚     â”‚  â”‚   â”‚
â”‚  â”‚  â”‚  â”‚  â€¢ Port 80  (HTTP)  â† 0.0.0.0/0             â”‚     â”‚  â”‚   â”‚
â”‚  â”‚  â”‚  â”‚  â€¢ Port 443 (HTTPS) â† 0.0.0.0/0             â”‚     â”‚  â”‚   â”‚
â”‚  â”‚  â”‚  â”‚                                              â”‚     â”‚  â”‚   â”‚
â”‚  â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚     â”‚  â”‚   â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  EC2 Instance (Ubuntu 22.04)       â”‚    â”‚     â”‚  â”‚   â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  Type: t2.micro / t3.small         â”‚    â”‚     â”‚  â”‚   â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  Storage: 20GB EBS (encrypted)     â”‚    â”‚     â”‚  â”‚   â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  Public IP: Auto-assigned          â”‚    â”‚     â”‚  â”‚   â”‚
â”‚  â”‚  â”‚  â”‚  â”‚                                     â”‚    â”‚     â”‚  â”‚   â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚    â”‚     â”‚  â”‚   â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â”‚  Nginx (Port 80)             â”‚ â”‚    â”‚     â”‚  â”‚   â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â”‚  â€¢ Serves Frontend           â”‚ â”‚    â”‚     â”‚  â”‚   â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â”‚  â€¢ Reverse Proxy to Backend  â”‚ â”‚    â”‚     â”‚  â”‚   â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚    â”‚     â”‚  â”‚   â”‚
â”‚  â”‚  â”‚  â”‚  â”‚                                     â”‚    â”‚     â”‚  â”‚   â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚    â”‚     â”‚  â”‚   â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â”‚  Frontend (React)            â”‚ â”‚    â”‚     â”‚  â”‚   â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â”‚  Location: /var/www/...      â”‚ â”‚    â”‚     â”‚  â”‚   â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â”‚  Built with: Vite            â”‚ â”‚    â”‚     â”‚  â”‚   â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚    â”‚     â”‚  â”‚   â”‚
â”‚  â”‚  â”‚  â”‚  â”‚                                     â”‚    â”‚     â”‚  â”‚   â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚    â”‚     â”‚  â”‚   â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â”‚  Backend (Node.js)           â”‚ â”‚    â”‚     â”‚  â”‚   â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â”‚  Port: 3000                  â”‚ â”‚    â”‚     â”‚  â”‚   â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â”‚  Service: systemd            â”‚ â”‚    â”‚     â”‚  â”‚   â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â”‚  Express API                 â”‚ â”‚    â”‚     â”‚  â”‚   â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚    â”‚     â”‚  â”‚   â”‚
â”‚  â”‚  â”‚  â”‚  â”‚                                     â”‚    â”‚     â”‚  â”‚   â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚    â”‚     â”‚  â”‚   â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â”‚  PostgreSQL Database         â”‚ â”‚    â”‚     â”‚  â”‚   â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â”‚  Port: 5432 (localhost)      â”‚ â”‚    â”‚     â”‚  â”‚   â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â”‚  Database: bmidb             â”‚ â”‚    â”‚     â”‚  â”‚   â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â”‚  User: bmi_user              â”‚ â”‚    â”‚     â”‚  â”‚   â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚    â”‚     â”‚  â”‚   â”‚
â”‚  â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚     â”‚  â”‚   â”‚
â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚  â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚   â”‚
â”‚  â”‚                                                               â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚   â”‚
â”‚  â”‚  â”‚             Internet Gateway                          â”‚  â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                 â”‚
                                 â”‚
                            Internet
                                 â”‚
                                 â–¼
                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                        â”‚  End Users      â”‚
                        â”‚  (Web Browsers) â”‚
                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ”„ Request Flow

```
User Request â†’ Internet â†’ Internet Gateway â†’ Public Subnet
                                                    â”‚
                                                    â–¼
                                            Security Group
                                              (Port 80)
                                                    â”‚
                                                    â–¼
                                          Nginx on EC2 :80
                                                    â”‚
                         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                         â”‚                                                  â”‚
                         â–¼                                                  â–¼
                Static Files Request                            API Request (/api/*)
                (HTML, CSS, JS)                                             â”‚
                         â”‚                                                  â”‚
                         â–¼                                                  â–¼
                Frontend Files                                    Reverse Proxy
                /var/www/bmi-health-tracker/                              â”‚
                         â”‚                                                  â–¼
                         â”‚                                      Backend :3000
                         â”‚                                      (Express API)
                         â”‚                                                  â”‚
                         â”‚                                                  â–¼
                         â”‚                                      PostgreSQL :5432
                         â”‚                                      (bmidb database)
                         â”‚                                                  â”‚
                         â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â–¼
                   User Browser
```

## ğŸ“¦ Terraform Module Structure

```
terraform/
â”‚
â”œâ”€â”€ Root Module
â”‚   â”œâ”€â”€ main.tf           â”€â”€â”€â”€â”€â–º  Calls EC2 Module
â”‚   â”œâ”€â”€ variables.tf      â”€â”€â”€â”€â”€â–º  Defines inputs
â”‚   â”œâ”€â”€ outputs.tf        â”€â”€â”€â”€â”€â–º  Exposes outputs
â”‚   â””â”€â”€ backend.tf        â”€â”€â”€â”€â”€â–º  S3 state config
â”‚
â””â”€â”€ modules/ec2/
    â”œâ”€â”€ main.tf           â”€â”€â”€â”€â”€â–º  Creates EC2 instance
    â”œâ”€â”€ variables.tf      â”€â”€â”€â”€â”€â–º  Module inputs
    â””â”€â”€ outputs.tf        â”€â”€â”€â”€â”€â–º  Module outputs
```

## ğŸ” Security Layers

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      Security Layers                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  Layer 1: AWS Security Group                                   â”‚
â”‚  â€¢ Controls inbound/outbound traffic                           â”‚
â”‚  â€¢ Stateful firewall                                           â”‚
â”‚  â€¢ Port restrictions                                           â”‚
â”‚                                                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  Layer 2: Network Security (VPC)                               â”‚
â”‚  â€¢ Isolated network environment                                â”‚
â”‚  â€¢ Subnet-level controls                                       â”‚
â”‚  â€¢ Public/Private subnet separation                            â”‚
â”‚                                                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  Layer 3: Instance Security                                    â”‚
â”‚  â€¢ IMDSv2 enforced                                             â”‚
â”‚  â€¢ Encrypted EBS volumes                                       â”‚
â”‚  â€¢ SSH key authentication                                      â”‚
â”‚  â€¢ Regular security updates                                    â”‚
â”‚                                                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  Layer 4: Application Security                                 â”‚
â”‚  â€¢ Nginx security headers                                      â”‚
â”‚  â€¢ PostgreSQL password auth                                    â”‚
â”‚  â€¢ Systemd service isolation                                   â”‚
â”‚  â€¢ Environment variable secrets                                â”‚
â”‚                                                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  Layer 5: Data Security                                        â”‚
â”‚  â€¢ Database user permissions                                   â”‚
â”‚  â€¢ Connection encryption                                       â”‚
â”‚  â€¢ State file encryption (S3)                                  â”‚
â”‚  â€¢ Backup and recovery                                         â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸš€ Deployment Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Terraform Deployment Flow                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                            â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚ terraform init â”‚
                    â”‚ â€¢ Load modules â”‚
                    â”‚ â€¢ Init backend â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                            â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚ terraform plan â”‚
                    â”‚ â€¢ Parse config â”‚
                    â”‚ â€¢ Show changes â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                            â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚ terraform applyâ”‚
                    â”‚ â€¢ Create EC2   â”‚
                    â”‚ â€¢ Assign IP    â”‚
                    â”‚ â€¢ Run userdata â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚                               â”‚
            â–¼                               â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ EC2 Launched â”‚              â”‚ Userdata Runs  â”‚
    â”‚ â€¢ Instance   â”‚              â”‚ â€¢ Copy script  â”‚
    â”‚ â€¢ Storage    â”‚              â”‚ â€¢ Setup env    â”‚
    â”‚ â€¢ Network    â”‚              â”‚ â€¢ Run deploy   â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                                           â”‚
                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                        â”‚                                      â”‚
                        â–¼                                      â–¼
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚ Install Software   â”‚              â”‚ Configure Services    â”‚
            â”‚ â€¢ Node.js          â”‚              â”‚ â€¢ PostgreSQL setup    â”‚
            â”‚ â€¢ PostgreSQL       â”‚              â”‚ â€¢ Backend systemd     â”‚
            â”‚ â€¢ Nginx            â”‚              â”‚ â€¢ Nginx config        â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â”‚                                      â”‚
                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                           â”‚
                                           â–¼
                                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                â”‚ Deploy App       â”‚
                                â”‚ â€¢ Backend build  â”‚
                                â”‚ â€¢ Frontend build â”‚
                                â”‚ â€¢ Start services â”‚
                                â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                         â”‚
                                         â–¼
                                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                â”‚ Application     â”‚
                                â”‚ Ready! ğŸ‰       â”‚
                                â”‚ http://<IP>     â”‚
                                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ”„ Application Data Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                BMI Health Tracker - Data Flow                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

User Input (Browser)
        â”‚
        â”‚ HTTP Request
        â–¼
   Nginx :80 â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                  â”‚
        â”‚                  â”‚ Static Files (HTML/CSS/JS)
        â”‚                  â”‚
        â”‚ /api/* requests  â–¼
        â”‚              React App
        â”‚              (Frontend)
        â”‚                  â”‚
        â–¼                  â”‚
Backend :3000              â”‚
(Express API)              â”‚
        â”‚                  â”‚
        â”‚ SQL Queries      â”‚
        â–¼                  â”‚
PostgreSQL :5432           â”‚
(Database)                 â”‚
        â”‚                  â”‚
        â”‚ Query Results    â”‚
        â–¼                  â”‚
Backend :3000              â”‚
        â”‚                  â”‚
        â”‚ JSON Response    â”‚
        â–¼                  â”‚
   Nginx :80               â”‚
        â”‚                  â”‚
        â”‚ HTTP Response    â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â”‚
                â–¼
        User Browser
        (Display Results)


Specific Example: Create BMI Record
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

1. User fills form â†’ Frontend (React)
                            â”‚
                            â–¼
2. POST /api/measurements
   { height, weight, date }
                            â”‚
                            â–¼
3. Nginx forwards â†’ Backend :3000
                            â”‚
                            â–¼
4. Calculate BMI
   Express validates data
                            â”‚
                            â–¼
5. INSERT INTO measurements
   PostgreSQL executes
                            â”‚
                            â–¼
6. Return row ID
   { id: 123, bmi: 24.5 }
                            â”‚
                            â–¼
7. JSON response â†’ Frontend
                            â”‚
                            â–¼
8. Update UI with new record
   Show success message
```

## ğŸ“ File System Layout on EC2

```
/
â”œâ”€â”€ home/
â”‚   â””â”€â”€ ubuntu/
â”‚       â””â”€â”€ bmi-health-tracker/          â† Application root
â”‚           â”œâ”€â”€ IMPLEMENTATION_AUTO.sh   â† Deployment script
â”‚           â”œâ”€â”€ backend/
â”‚           â”‚   â”œâ”€â”€ .env                 â† Config (DB credentials)
â”‚           â”‚   â”œâ”€â”€ package.json
â”‚           â”‚   â”œâ”€â”€ node_modules/
â”‚           â”‚   â”œâ”€â”€ src/
â”‚           â”‚   â”‚   â”œâ”€â”€ server.js        â† Entry point
â”‚           â”‚   â”‚   â”œâ”€â”€ routes.js
â”‚           â”‚   â”‚   â”œâ”€â”€ db.js
â”‚           â”‚   â”‚   â””â”€â”€ ...
â”‚           â”‚   â””â”€â”€ migrations/
â”‚           â”‚       â”œâ”€â”€ 001_create_measurements.sql
â”‚           â”‚       â””â”€â”€ 002_add_measurement_date.sql
â”‚           â””â”€â”€ frontend/
â”‚               â”œâ”€â”€ package.json
â”‚               â”œâ”€â”€ dist/                â† Build output (deployed)
â”‚               â””â”€â”€ src/
â”‚                   â”œâ”€â”€ main.jsx
â”‚                   â”œâ”€â”€ App.jsx
â”‚                   â””â”€â”€ components/
â”‚
â”œâ”€â”€ var/
â”‚   â”œâ”€â”€ www/
â”‚   â”‚   â””â”€â”€ bmi-health-tracker/          â† Nginx serves from here
â”‚   â”‚       â”œâ”€â”€ index.html
â”‚   â”‚       â”œâ”€â”€ assets/
â”‚   â”‚       â”‚   â”œâ”€â”€ index-*.js
â”‚   â”‚       â”‚   â””â”€â”€ index-*.css
â”‚   â”‚       â””â”€â”€ ...
â”‚   â”‚
â”‚   â””â”€â”€ log/
â”‚       â”œâ”€â”€ cloud-init-output.log        â† Userdata execution log
â”‚       â”œâ”€â”€ user-data.log                â† Custom userdata log
â”‚       â”œâ”€â”€ bmi-deployment.log           â† Deployment script log
â”‚       â”œâ”€â”€ bmi-backend.log              â† Backend service log
â”‚       â””â”€â”€ nginx/
â”‚           â”œâ”€â”€ bmi-access.log           â† Nginx access log
â”‚           â””â”€â”€ bmi-error.log            â† Nginx error log
â”‚
â”œâ”€â”€ etc/
â”‚   â”œâ”€â”€ nginx/
â”‚   â”‚   â”œâ”€â”€ nginx.conf
â”‚   â”‚   â”œâ”€â”€ sites-available/
â”‚   â”‚   â”‚   â””â”€â”€ bmi-health-tracker       â† Nginx site config
â”‚   â”‚   â””â”€â”€ sites-enabled/
â”‚   â”‚       â””â”€â”€ bmi-health-tracker       â† Symlink
â”‚   â”‚
â”‚   â”œâ”€â”€ systemd/
â”‚   â”‚   â””â”€â”€ system/
â”‚   â”‚       â””â”€â”€ bmi-backend.service      â† Backend systemd service
â”‚   â”‚
â”‚   â””â”€â”€ postgresql/
â”‚       â””â”€â”€ ...
â”‚
â””â”€â”€ usr/
    â””â”€â”€ share/
        â””â”€â”€ postgresql/
```

## ğŸ¯ Port Mapping

```
External World                     EC2 Instance
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                 â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

Internet :80  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º  Nginx :80 â”€â”€â”
                                        â”‚
Internet :443 â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º  Nginx :443  â”‚
     (future SSL)                       â”‚
                                        â”œâ”€â–º /var/www/... (Static)
                                        â”‚
                                        â””â”€â–º Backend :3000 (API)
                                                    â”‚
                                                    â–¼
                                            PostgreSQL :5432
                                            (localhost only)


SSH :22       â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º  SSH :22
   (Your IP only)           (Key-based auth)
```

## ğŸ·ï¸ Tagging Strategy

```
All Resources Tagged With:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Project     = "BMI-Health-Tracker"  â”‚
â”‚ Environment = "dev"                  â”‚
â”‚ ManagedBy   = "Terraform"            â”‚
â”‚ Application = "BMI-Health-Tracker"   â”‚
â”‚ Tier        = "Full-Stack"           â”‚
â”‚ + Custom Tags (from variables)       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Benefits:
â€¢ Cost allocation
â€¢ Resource grouping
â€¢ Automation
â€¢ Compliance tracking
â€¢ Easy filtering
```

## ğŸ“Š State Management

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  Terraform State Flow                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Local Machine                      AWS
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                    â”€â”€â”€â”€â”€

terraform apply  â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º  Create Resources
       â”‚                           â”‚
       â”‚                           â–¼
       â”‚                    EC2, Security Groups, etc.
       â”‚
       â–¼
Save State â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º  S3 Bucket
                             â€¢ Encrypted
                             â€¢ Versioned
                             â€¢ Remote
                             â€¢ Shared

Next Run:
terraform plan   â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€  Load State from S3
       â”‚
       â–¼
Compare desired vs actual
       â”‚
       â–¼
Show changes


State File Contains:
â”œâ”€â”€ Resource IDs (EC2 instance ID, etc.)
â”œâ”€â”€ Current configuration
â”œâ”€â”€ Dependencies
â”œâ”€â”€ Outputs
â””â”€â”€ Sensitive data (DB passwords!)
    âš ï¸  Keep secure!
```

---

These diagrams provide a complete visual understanding of the infrastructure! ğŸ¨

---

## ğŸ§‘â€ğŸ’» Author
**Md. Sarowar Alam**  
Lead DevOps Engineer, Hogarth Worldwide  
ğŸ“§ Email: sarowar@hotmail.com  
ğŸ”— LinkedIn: [linkedin.com/in/sarowar](https://www.linkedin.com/in/sarowar/)

---
